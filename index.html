<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8>
    <title>Solar System to Scale</title>
    <style>
    body {
        margin: 0;
    }
    
    canvas {
        width: 100vw;
        height: 100vh;
    }
    </style>
</head>

<body>
    <script src="three.min.js"></script>
    <script src="TrackballControls.js"></script>
    <script>
    var scene = new THREE.Scene();
    var width = window.innerWidth;
    var height = window.innerHeight;
    var fov = 45;
    var near = 0.001;
    var far = 100000;
    var camera = new THREE.PerspectiveCamera(fov, width / height, near, far);
    /*new THREE.OrthographicCamera(width / -0.01, width / 0.01, height / 0.01, height / -0.01, near, far);*/

    camera.position.z = 15000;

    var controls = new THREE.TrackballControls(camera);

    controls.rotateSpeed = 1;
    controls.zoomSpeed = 1.2;
    controls.panSpeed = 0.8;

    controls.noZoom = false;
    controls.noPan = false;

    controls.staticMoving = true;
    controls.dynamicDampingFactor = 0.3;

    controls.keys = [65, 83, 68];

    controls.addEventListener('change', render);

    var planets = [{
        name: "Mercury",
        majorAxis: "115818100",
        minorAxis: "57909050",
        offset: "69816900",
        tilt: "",
        angle : 285.55,
        radius: "2439.7",
        color: 0xefefef,
        texture: "img/mercurymap.jpg",
        timePeriod: "0.240846"
    }, {
        name: "Venus",
        majorAxis: "216416000",
        minorAxis: "108208000",
        offset: "108939000",
        tilt: "",
        angle : 94.13,
        radius: "6051.8",
        color: 0xff6600,
        texture: "img/venusmap.jpg",
        timePeriod: "0.615198"
    }, {
        name: "Earth",
        majorAxis: "299025000",
        minorAxis: "149598261",
        offset: "151930000",
        tilt: "",
        angle : 100.46,
        radius: "6371",
        color: 0x3333ff,
        texture: "img/earthmap1k_clouds.jpg",
        timePeriod: "1.000017421"
    }, {
        name: "Mars",
        majorAxis: "455900000",
        minorAxis: "227939100",
        offset: "249200000",
        tilt: "",
        angle : 155.60,
        radius: "3389.5",
        color: 0xff1100,
        texture: "img/mars_1k_color.jpg",
        timePeriod: "1.88"
    }, {
        name: "Jupiter",
        majorAxis: "1557094400",
        minorAxis: "778547200",
        offset: "816520800",
        tilt: "",
        angle : 104.92,
        radius: "69911",
        color: 0xff6633,
        texture: "img/jupitermap.jpg",
        timePeriod: "11.8618"
    }, {
        name: "Saturn",
        majorAxis: "2866898739",
        minorAxis: "1433449370",
        offset: "1513325783",
        tilt: "",
        angle : 226.71,
        radius: "58232",
        color: 0xffbb66,
        texture: "img/saturnmap.jpg",
        timePeriod: "29.4571"
    }, {
        name: "Uranus",
        majorAxis: "5741342800",
        minorAxis: "2870671400",
        offset: "3006224700",
        tilt: "",
        angle : 11.93,
        radius: "25362",
        color: 0x55aaff,
        texture: "img/uranusmap.jpg",
        timePeriod: "84.016846"
    }, {
        name: "Neptune",
        majorAxis: "8997085300",
        minorAxis: "4498542600",
        offset: "4537580900",
        tilt: "",
        angle : 334.90,
        radius: "24622",
        color: 0xbbaaff,
        texture: "img/neptunemap.jpg",
        timePeriod: "164.8"
    }];

    var rSun = 696342 / 10000;

    var gSun = new THREE.SphereGeometry(rSun, 50, 50);

    var mSun = new THREE.MeshBasicMaterial();
    mSun.map = THREE.ImageUtils.loadTexture('img/sunmap.jpg');
    /*new THREE.MeshBasicMaterial({
        color: 0xffff00
    });*/

    var Sun = new THREE.Mesh(gSun, mSun);
    scene.add(Sun);


    var getPlanetPosition = function(idx, t) {
        var position = {};
        position.x = ((planets[idx].majorAxis / 10000) * Math.cos(t / planets[idx].timePeriod)) + (planets[idx].offset / 10000);
        position.y = (planets[idx].minorAxis / 10000) * Math.sin(t / planets[idx].timePeriod) + 0;
        return position;
    };

    var addPlanet = function(p) {
        var quaternion = new THREE.Quaternion();
        quaternion.setFromAxisAngle(new THREE.Vector3(1, 1, 1), Math.PI / 2);
        var pGeom = new THREE.SphereGeometry(p.radius / 10, 32, 32);
        var pMat = new THREE.MeshBasicMaterial();
        pMat.map = THREE.ImageUtils.loadTexture(p.texture);
        /*new THREE.MeshBasicMaterial({
            color: p.color
        });*/

        var planet = new THREE.Mesh(pGeom, pMat);
        planet.name = p.name;
        scene.add(planet);

        var curve = new THREE.EllipseCurve(
            p.offset / 10000, 0, // ax, aY
            p.majorAxis / 10000, p.minorAxis / 10000, // xRadius, yRadius
            0, 2 * Math.PI, // aStartAngle, aEndAngle
            false, // aClockwise
            0 // aRotation 
        );
        var path = new THREE.Path(curve.getPoints(1000));
        var pathGeom = path.createPointsGeometry(1000);
        var pathMat = new THREE.LineBasicMaterial({
            color: 0xefefef
        });

        // Create the final Object3d to add to the scene
        var ellipse = new THREE.Line(pathGeom, pathMat);
        scene.add(ellipse);
    };



    for (var i in planets) {
        addPlanet(planets[i]);
    }


    var t = 0;
    var renderer = new THREE.WebGLRenderer();
    var zoomIn = false;
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);
    render();
    animate();

    function render() {

        //requestAnimationFrame(render);
        t += 0.02;

        for (var j in scene.children) {
            for (var k in planets) {
                if (scene.children[j].name === planets[k].name) {
                    var position = {};
                    position = getPlanetPosition(k, t);
                    scene.children[j].position.x = position.x;
                    scene.children[j].position.y = position.y;
                    break;
                }
            }
        }
        renderer.render(scene, camera);
    }

    function animate() {

        requestAnimationFrame(animate);
        controls.update();

    }
    </script>
</body>

</html>
